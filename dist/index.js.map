{"version":3,"file":"index.js","sources":["../node_modules/tslib/tslib.es6.js","../src/dom-fns.ts","../src/music-fns.ts","../src/iter.ts","../src/array-fns.ts","../src/helper-fns.ts","../src/index.ts","../src/init-get-user-media.ts","../src/math-fns.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","export const toggleClass = (element: HTMLElement, ...cls: string[]) => {\n  element.classList.remove(...cls);\n\n  // Force layout reflow\n  void element.offsetWidth;\n\n  element.classList.add(...cls);\n};\n","export type NoteString = 'C' | 'C#' | 'D' | 'D#' | 'E' | 'F' | 'F#' | 'G' | 'G#' | 'A' | 'A#' | 'B';\n\nexport const middleA = 440;\n\nexport const SEMI_TONE = 69;\nexport const NOTE_STRINGS: NoteString[] = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\nexport interface Note {\n  value: number,\n  index: number,\n  name: NoteString\n  cents: number\n  octave: number,\n  frequency: number,\n}\n\nexport function getNote(frequency: number): Note {\n  const noteIndex = getNoteIndex(frequency);\n  // console.log(`${NOTE_STRINGS[noteIndex % 12]}_${Math.floor(noteIndex / 12) - 1}`, noteIndex)\n  return {\n    value: noteIndex % 12,\n    index: noteIndex,\n    name: NOTE_STRINGS[noteIndex % 12],\n    cents: getCents(frequency, noteIndex),\n    octave: Math.floor(noteIndex / 12) - 1,\n    frequency: frequency,\n  };\n}\n\n/**\n * Get musical note from frequency\n */\nexport function getNoteIndex(frequency: number) {\n  const note = 12 * (Math.log(frequency / middleA) / Math.log(2))\n  return Math.round(note) + SEMI_TONE\n}\n\n/**\n * Get the musical note's standard frequency\n */\nexport function getStandardFrequency(note: number) {\n  return middleA * (2 ** ((note - SEMI_TONE) / 12));\n}\n\n/**\n * Get cents difference between given frequency and musical note's standard frequency\n */\nexport function getCents(frequency: number, note: number) {\n  return Math.floor((1200 * Math.log(frequency / getStandardFrequency(note))) / Math.log(2));\n}\n\nexport function volumeAudioProcess(buf: Float32Array) {\n  let bufLength = buf.length;\n  let sum = 0;\n  let x;\n\n  // Do a root-mean-square on the samples: sum up the squares...\n  for (let i = 0; i < bufLength; i++) {\n    x = buf[i];\n    sum += x * x;\n  }\n\n  // ... then take the square root of the sum.\n  let rms = Math.sqrt(sum / bufLength);\n\n  return rms;\n}\n\n","/** Allows an iterator to be used within a for loop to continue the iteration */\nexport function cont<T>(it: Iterator<T>) {\n  return { [Symbol.iterator]() { return it } }\n}\n\nexport function* groupedUntilChanged<X>(xs: Iterable<X>, equals: (a: X, b: X) => boolean = (a, b) => a === b): IterableIterator<X[]> {\n  const it = xs[Symbol.iterator]();\n  const { done, value: initial } = it.next();\n  if (done) return;\n\n  let group: X[] = [];\n\n  group.push(initial);\n  let prev = initial;\n\n  for (const x of cont(it)) {\n    if (equals(x, prev)) {\n      group.push(x);\n      prev = x;\n    } else {\n      yield [...group];\n      group = [x];\n      prev = x;\n    }\n  }\n\n  if (group.length) yield group\n}\n\nexport function first<X>(xs: Iterable<X>) {\n  for (const x of xs) return x;\n}","export const queue = <T>(a: T[] | null | undefined, x: T) => \n  (a?.pop(), a?.unshift(x), a);\n\nexport const closest = (a: number[], goal: number) => \n  a.reduce((prev, curr) => (Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev));","export const set = (obj: any, prop: any, value: any) => obj && (obj[prop] = value);\nexport const isTruthy = (x: any) => !!x;\nexport const isFalsey = (x: any) => !x;\nexport const throwError = (m?: string) => { throw Error(m) };\n\nexport const debounce = (delay: number, fn: (...args: any[]) => any) => {\n  let timer: any;\n  return (...args: any[]) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => fn(...args), delay);\n  };\n};\n\nexport const throttle = (limit: number, fn: (...args: any[]) => any) => {\n  let wait = false;\n  return (...args: any[]) => {\n    if (!wait) {\n      fn(...args);\n      wait = true;\n      setTimeout(() => { wait = false }, limit);\n    }\n  }\n};","/**\n * Copyright (C) 2021 Online Mic Test\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published\n * by the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n * @license\n */\n\nimport { initGetUserMedia } from \"./init-get-user-media\";\nimport { toggleClass } from \"./dom-fns\";\nimport { getNote } from \"./music-fns\";\nimport { groupedUntilChanged } from \"./iter\";\nimport { closest, queue } from \"./array-fns\";\nimport { isTruthy, set, throttle, throwError } from \"./helper-fns\";\nimport { clamp, round } from \"./math-fns\";\n\nconsole.log('Licensed under AGPL-3.0: https://github.com/onlinemictest/guitar-tuner')\n\nconst BUFFER_SIZE = 2 ** 13;\n\n// Note buffer sizes\nconst PREV_BUFFER_SIZE = Math.ceil(3 / 2);\nconst NOOP_BUFFER_SIZE = 36 / 2;\nconst TUNE_BUFFER_SIZE = 12 / 2;\n\nconst GUITAR_FREQ = {\n  'E_4': 329.63,\n  'B_3': 246.94,\n  'G_3': 196.00,\n  'D_3': 146.83,\n  'A_2': 110.00,\n  'E_2': 82.41,\n};\ntype GuitarNoteName = keyof typeof GUITAR_FREQ;\nconst GUITAR_NOTES = Object.keys(GUITAR_FREQ) as GuitarNoteName[];\nconst GUITAR_FREQ_INV = new Map(Object.entries(GUITAR_FREQ).map(([a, b]) => [b, a])) as Map<number, GuitarNoteName>\nconst GUITAR_FREQ_VAL = Object.values(GUITAR_FREQ).sort();\n\nconst ANIM_DURATION = 350;\n\nconst translate = {\n  X: 'translateX',\n  Y: 'translateY',\n}\n\nconst getClosestGuitarNote = (f: number) => GUITAR_FREQ_INV.get(closest(GUITAR_FREQ_VAL, f)) ?? throwError();\n\ninitGetUserMedia();\n\nif (false\n  || !('WebAssembly' in window) \n  || !('AudioContext' in window) \n  || !('createAnalyser' in AudioContext.prototype) \n  || !('createScriptProcessor' in AudioContext.prototype) \n) {\n  if (!('WebAssembly' in window)) throw alert(`Browser not supported: 'WebAssembly' is not defined`);\n  if (!('AudioContext' in window)) throw alert(`Browser not supported: 'AudioContext' is not defined`)\n  if (!('createAnalyser' in AudioContext.prototype)) throw alert(`Browser not supported: 'AudioContext.prototype.createAnalyser' is not defined`)\n  if (!('createScriptProcessor' in AudioContext.prototype)) throw alert(`Browser not supported: 'AudioContext.prototype.createScriptProcessor' is not defined`)\n}\n\n// @ts-expect-error\nAubio().then(({ Pitch }) => {\n  const guitarTuner = document.getElementById('guitar-tuner') as HTMLDivElement | null;\n  const startEl = document.getElementById('audio-start') as HTMLButtonElement | null;\n  const pauseEl = document.getElementById('audio-pause') as HTMLButtonElement | null;\n  const tuneUpText = document.getElementById('tune-up-text') as HTMLDivElement | null;\n  const tuneDownText = document.getElementById('tune-down-text') as HTMLDivElement | null;\n  const pressPlay = document.getElementById('circle-text-play') as HTMLSpanElement | null\n  const pluckAString = document.getElementById('circle-text-pluck') as HTMLSpanElement | null;\n  const errorEl = document.getElementById('circle-text-error') as HTMLSpanElement | null;\n  const noteSpan = document.getElementById('circle-text-note') as HTMLSpanElement | null;\n  const matchCircleL = document.getElementById('match-circle-l') as HTMLDivElement | null;\n  const matchCircleR = document.getElementById('match-circle-r') as HTMLDivElement | null;\n  const innerCircle = document.getElementById('inner-circle') as HTMLDivElement | null;\n\n  const tunedJingle = document.getElementById('tuned-jingle') as HTMLAudioElement;\n  tunedJingle.volume = 0.5;\n\n  const noteEls = new Map(Object.entries(GUITAR_FREQ).map(([n]) => [n, document.getElementById(n) as unknown as SVGGElement]));\n  const fillEls = new Map(Object.entries(GUITAR_FREQ).map(([n]) => [n, document.getElementById(`${n}-fill`) as unknown as SVGGElement]));\n\n  if (false\n    || !guitarTuner\n    || !startEl\n    || !pauseEl\n    || !tuneUpText\n    || !tuneDownText\n    || !pressPlay\n    || !pluckAString\n    || !errorEl\n    || !noteSpan\n    || !matchCircleL\n    || !matchCircleR\n    || !innerCircle\n    || !tunedJingle\n    || ![...noteEls.values()].every(isTruthy)\n    || ![...fillEls.values()].every(isTruthy)\n  ) {\n    return alert('Expected HTML element missing');\n  }\n\n  const updateTuneText = throttle(500, (isTooLow: boolean, isClose: boolean) => {\n    if (isClose) {\n      tuneUpText.classList.remove('show');\n      tuneDownText.classList.remove('show');\n    } else {\n      tuneUpText.classList[isTooLow ? 'add' : 'remove']('show');\n      tuneDownText.classList[isTooLow ? 'remove' : 'add']('show');\n    }\n  });\n\n  let audioContext: AudioContext;\n  let analyser: AnalyserNode;\n  let scriptProcessor: ScriptProcessorNode;\n  let pitchDetector: Aubio.Pitch;\n  // let stream: MediaStream;\n\n  matchCircleL.style.transform = `${translate.Y}(125%)`;\n\n  const pauseCallback = () => {\n    startEl.style.display = 'block';\n    pauseEl.style.display = 'none';\n    pressPlay.style.display = 'inline';\n    pluckAString.style.display = 'none';\n    noteSpan.style.display = 'none';\n    matchCircleR.style.color = '';\n    matchCircleL.style.transform = `${translate.Y}(125%)`;\n    tuneUpText.classList.remove('show');\n    tuneDownText.classList.remove('show');\n    toggleClass(startEl, 'blob-animation');\n  };\n\n  pauseEl.addEventListener('click', () => {\n    scriptProcessor.disconnect(audioContext.destination);\n    analyser.disconnect(scriptProcessor);\n    audioContext.close();\n    // stream.getTracks().forEach(track => track.stop());\n    pauseCallback();\n  });\n\n  startEl.addEventListener('click', async () => {\n    guitarTuner.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    startEl.style.display = 'none';\n    pauseEl.style.display = 'block';\n    toggleClass(pauseEl, 'shrink-animation');\n    await new Promise(r => requestAnimationFrame(r));\n\n    audioContext = new AudioContext();\n    analyser = audioContext.createAnalyser();\n    scriptProcessor = audioContext.createScriptProcessor(BUFFER_SIZE, 1, 1);\n    pitchDetector = new Pitch('default', BUFFER_SIZE, 1, audioContext.sampleRate);\n    // pitchDetector.setSilence(-70);\n\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      console.log(stream);\n      // stream = s;\n      audioContext.createMediaStreamSource(stream).connect(analyser);\n      analyser.connect(scriptProcessor);\n      scriptProcessor.connect(audioContext.destination);\n\n      pressPlay.style.display = 'none';\n      errorEl.style.display = 'none';\n      pluckAString.style.display = 'inline';\n      matchCircleL.style.visibility = 'visible';\n\n      // let prevCents = -50;\n      // let prevNote = '';\n\n      let resetable = false;\n      let softResettable = false;\n      let jinglePlayed = false;\n\n      /** The last 3 notes excluding undefined */\n      const prevNotes: string[] = new Array(PREV_BUFFER_SIZE).fill(undefined);\n\n      /** The last 36 notes (prox. 2 seconds). Used to fully reset the UI when there's only noise. */\n      const noopBuffer: string[] = new Array(NOOP_BUFFER_SIZE).fill(undefined);\n\n      /** A buffer of the last 36 cents values for each guitar note. Used to determine if a string is tuned. */\n      let centsBufferMap: Map<string, number[]> = new Map(GUITAR_NOTES.map(nn => [nn, []]));\n\n      // /** The last 3 notes including undefined. Used to reset the cents buffer between plucks of the string */\n      // const pauseBuffer: string[] = new Array(PREV_BUFFER_SIZE).fill(undefined);\n\n      scriptProcessor.addEventListener('audioprocess', event => {\n        // console.timeEnd('foo');\n        // console.time('foo');\n\n        const buffer = event.inputBuffer.getChannelData(0)\n        // const volume = volumeAudioProcess(buffer);\n        const frequency = pitchDetector.do(buffer);\n        const note = getNote(frequency);\n\n        queue(noopBuffer, note.name);\n\n        // If there has been nothing but noise for the last couple of seconds, show the message again:\n        const isNoise = [...groupedUntilChanged(noopBuffer.filter(isTruthy))].every(g => g.length <= 3);\n        if (isNoise) {\n          if (resetable) {\n            resetable = false;\n            pressPlay.style.display = 'none';\n            pluckAString.style.display = 'inline';\n            noteSpan.style.display = 'none';\n            matchCircleR.style.color = '';\n            matchCircleL.style.transform = `${translate.Y}(125%)`;\n            tuneUpText.classList.remove('show');\n            tuneDownText.classList.remove('show');\n          }\n        }\n        else if (note.name && !Number.isNaN(note.cents)) {\n          if (tunedJingle.paused) {\n            resetable = true;\n            softResettable = true;\n\n            const noteName = `${note.name}_${note.octave}`;\n            const guitarNoteName = getClosestGuitarNote(frequency);\n\n            // Show tune up/down text iff frequency is way off (more than 25 cents)\n            const isTooLow = frequency < GUITAR_FREQ[guitarNoteName];\n            const isClose = noteName === guitarNoteName && note.cents < 5;\n            updateTuneText(isTooLow, isClose);\n\n            // console.log(note);\n\n            // if (prevNote == note.name)\n            // const degDiff = Math.trunc(Math.abs(prevDeg - deg));\n            // prevDeg = deg;\n            // const transformTime = (degDiff + 25) * 15;\n            // console.log(noteName, note.cents)\n\n            const baseCents = noteName === guitarNoteName\n              ? note.cents\n              : isTooLow ? -85 : 85;\n\n            const absCents100 = Math.abs(baseCents) * 2;\n            const sensitivity = Math.min(10, Math.round(100 / absCents100));\n            const centsUI = round(baseCents, sensitivity);\n\n            // console.log(`${absCents2}/100 => %${sensitivity} => ${Math.abs(centsApprox) * 2}/100`);\n            // const centsApprox = note.cents;\n            // console.log(centsApprox)\n\n            // const transitionTime = 200 + Math.abs(prevCents - centsApprox) * 10;\n            // console.log(transitionTime)\n\n            // matchCircleR.style.transform = `translateY(${note.cents}%)`;\n            pluckAString.style.display = 'none';\n            noteSpan.style.display = 'inline';\n            noteSpan.innerText = guitarNoteName.split('_')[0];\n\n            const centsBuffer = centsBufferMap.get(noteName) ?? [];\n            if (noteName === guitarNoteName && centsUI === 0) centsBuffer.push(0);\n\n            const tuneRatio = clamp((centsBuffer.length - 1) / TUNE_BUFFER_SIZE);\n            // console.log(noteName, tuneRatio)\n            innerCircle.style.transition = `transform ${ANIM_DURATION}ms ease`\n            innerCircle.style.transform = `scale(${1 - tuneRatio})`;\n\n            matchCircleR.style.transition = `color ${ANIM_DURATION}ms ease`\n            matchCircleR.style.color = tuneRatio === 1 ? '#fff' : '#fff8';\n\n            matchCircleL.style.transition = `transform ${ANIM_DURATION}ms ease`;\n            matchCircleL.style.transform = `${translate.Y}(${-centsUI * (1 - tuneRatio)}%)`;\n\n            if (tuneRatio === 1 && !jinglePlayed) {\n              setTimeout(() => tunedJingle.play(), ANIM_DURATION); // give animation time to finish\n              set(noteEls.get(guitarNoteName)?.querySelector('path')?.style, 'fill', 'rgb(67,111,142)');\n              set(fillEls.get(guitarNoteName)?.style, 'display', 'block');\n              jinglePlayed = true;\n            }\n\n            // console.log(`Streak: ${centsHits.length}/${centsBuffer.length}`)\n\n            // prevCents = centsUI;\n            // prevNote = noteName;\n          }\n\n          queue(prevNotes, note.name);\n        }\n        else if (softResettable) {\n          // console.log('soft reset');\n          innerCircle.style.transition = 'transform 100ms'\n          innerCircle.style.transform = `scale(1)`;\n          softResettable = false;\n          jinglePlayed = false;\n          centsBufferMap = new Map(GUITAR_NOTES.map(nn => [nn, []]));\n        }\n\n        // // console.log(pauseBuffer)\n        // queue(pauseBuffer, note.name);\n      });\n    } catch (err) {\n      pauseCallback();\n      pressPlay.style.display = 'none';\n      errorEl.innerText = err.message;\n      errorEl.style.display = 'block';\n    };\n  });\n});\n","export function initGetUserMedia() {\n  // @ts-ignore\n  window.AudioContext = window.AudioContext || window.webkitAudioContext\n  if (!window.AudioContext) {\n    return alert('AudioContext not supported')\n  }\n\n  // Older browsers might not implement mediaDevices at all, so we set an empty object first\n  if (navigator.mediaDevices === undefined) {\n    // @ts-ignore\n    navigator.mediaDevices = {}\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n  if (navigator.mediaDevices.getUserMedia === undefined) {\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      // First get ahold of the legacy getUserMedia, if present\n      // @ts-ignore\n      const getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia\n\n      // Some browsers just don't implement it - return a rejected promise with an error\n      // to keep a consistent interface\n      if (!getUserMedia) {\n        alert('getUserMedia is not implemented in this browser')\n      }\n\n      // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n      return new Promise(function (resolve, reject) {\n        getUserMedia.call(navigator, constraints, resolve, reject)\n      })\n    }\n  }\n}","export const floor = (n: number, basis = 1) => Math.floor(n / basis) * basis;\nexport const ceil = (n: number, basis = 1) => Math.ceil(n / basis) * basis;\nexport const round = (n: number, basis = 1) => Math.round(n / basis) * basis;\nexport const clamp = (n: number) => Math.max(0, Math.min(1, n));"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","toggleClass","element","cls","classList","remove","offsetWidth","add","NOTE_STRINGS","getNote","frequency","noteIndex","note","Math","log","round","getNoteIndex","index","name","cents","getCents","octave","floor","getStandardFrequency","groupedUntilChanged","xs","equals","a","b","it","Symbol","iterator","initial","group","push","prev","x","[object Object]","cont","length","queue","pop","unshift","set","obj","prop","isTruthy","console","BUFFER_SIZE","PREV_BUFFER_SIZE","ceil","GUITAR_FREQ","E_4","B_3","G_3","D_3","A_2","E_2","GUITAR_NOTES","Object","keys","GUITAR_FREQ_INV","Map","entries","map","GUITAR_FREQ_VAL","values","sort","translate","getClosestGuitarNote","f","goal","get","reduce","curr","abs","m","Error","throwError","window","AudioContext","webkitAudioContext","alert","undefined","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","call","initGetUserMedia","prototype","Aubio","Pitch","guitarTuner","document","getElementById","startEl","pauseEl","tuneUpText","tuneDownText","pressPlay","pluckAString","errorEl","noteSpan","matchCircleL","matchCircleR","innerCircle","tunedJingle","volume","noteEls","n","fillEls","every","updateTuneText","limit","fn","wait","args","setTimeout","throttle","isTooLow","isClose","audioContext","analyser","scriptProcessor","pitchDetector","style","transform","pauseCallback","display","color","addEventListener","disconnect","destination","close","scrollIntoView","behavior","block","r","requestAnimationFrame","createAnalyser","createScriptProcessor","sampleRate","stream","audio","createMediaStreamSource","connect","visibility","resetable","softResettable","jinglePlayed","prevNotes","Array","fill","noopBuffer","centsBufferMap","nn","event","buffer","inputBuffer","getChannelData","do","filter","g","Number","isNaN","paused","noteName","guitarNoteName","baseCents","absCents100","centsUI","basis","min","innerText","split","centsBuffer","tuneRatio","max","transition","play","querySelector","err","message"],"mappings":"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"}